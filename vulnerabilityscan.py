import socket
import argparse

def vulnerability_scanner(target, port, vuln_list):
    """
    Scan a target IP address and port for specified vulnerabilities in the banner.

    Args:
    - target (str): Target IP address.
    - port (int): Target port number.
    - vuln_list (list): List of vulnerabilities to check for in the banner.

    Returns:
    - None
    """
    try:
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(2)  # Set a timeout for socket operations
        sock.connect((target, port))
        banner = sock.recv(1024).decode().strip()
        for vuln in vuln_list:
            if vuln in banner:
                print(f"Vulnerability found: {vuln} on port {port}")
        sock.close()
    except socket.timeout:
        print(f"Connection timeout while scanning port {port}")
    except socket.error as e:
        print(f"Error scanning for vulnerabilities on port {port}: {e}")

def display_splash_screen():
    """
    Display the splash screen with ASCII art and usage instructions.
    """
    blue = '\033[94m'
    reset = '\033[0m'
    print(f"""{blue}
########  ##     ## ########  ########  ##       ######## ########     ###    #### ##    ## 
##     ## ##     ## ##     ## ##     ## ##       ##       ##     ##   ## ##    ##  ###   ## 
##     ## ##     ## ##     ## ##     ## ##       ##       ##     ##  ##   ##   ##  ####  ## 
########  ##     ## ########  ########  ##       ######   ########  ##     ##  ##  ## ## ## 
##        ##     ## ##   ##   ##        ##       ##       ##   ##   #########  ##  ##  #### 
##        ##     ## ##    ##  ##        ##       ##       ##    ##  ##     ##  ##  ##   ### 
##         #######  ##     ## ##        ######## ######## ##     ## ##     ## #### ##    ## 

                                                                   
Usage:
    python vulnerability_scanner.py <target_ip> <port> [-v <vuln1> <vuln2> ...]

Example:
    python vulnerability_scanner.py 192.168.1.100 80 -v "Apache/2.4.29" "OpenSSH_7.6p1"
{reset}""")

def parse_arguments():
    """
    Parse command-line arguments.
    """
    parser = argparse.ArgumentParser(description="Vulnerability Scanner Tool")
    parser.add_argument("target", help="Target IP address")
    parser.add_argument("port", type=int, help="Target port to scan")
    parser.add_argument("-v", "--vuln", nargs='+', help="List of vulnerabilities to check for")
    return parser.parse_args()

if __name__ == "__main__":
    display_splash_screen()
    args = parse_arguments()
    target = args.target
    port = args.port
    vuln_list = args.vuln if args.vuln else ["Apache/2.2.3", "OpenSSH_4.7"]

    print(f"Scanning {target}:{port} for vulnerabilities...")
    vulnerability_scanner(target, port, vuln_list)

